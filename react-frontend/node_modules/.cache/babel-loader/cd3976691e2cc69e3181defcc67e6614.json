{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Stefan Madalin\\\\Desktop\\\\ProiectPW\\\\react-frontend\\\\src\\\\components\\\\VotePage\\\\VotePage.js\";\nimport React from \"react\";\nimport './VotePage.scss';\nimport axios from \"axios\";\n\nclass VotePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      'questions': [],\n      truthClicked: false,\n      dareClicked: false\n    };\n    this.getQuestion = this.getQuestion.bind(this);\n    this.onPrevClick = this.onPrevClick.bind(this);\n    this.onNextClick = this.onNextClick.bind(this);\n    this.pickAnswer = this.pickAnswer.bind(this);\n    this.getButtonText = this.getButtonText.bind(this);\n    this.onLikeClick = this.onLikeClick.bind(this);\n    this.onDislikeClick = this.onDislikeClick.bind(this);\n    this.onReportClick = this.onReportClick.bind(this);\n    this.onSend = this.onSend.bind(this);\n    this.sendScore = this.sendScore.bind(this);\n    this.getVoteUI = this.getVoteUI.bind(this);\n    this.getUserActionsUI = this.getUserActionsUI.bind(this);\n    this.getSubmitForm = this.getSubmitForm.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  componentDidMount() {\n    if ('id' in this.props.match.params) {\n      axios.post(`http://localhost:80/confirmation/${this.props.match.params.id}`).then(result => {\n        alert(result.data.message);\n      }).catch(error => {\n        if (error.response !== undefined) {\n          this.setState({\n            'register_message': error.response.data.error\n          });\n        } else {\n          console.log(error);\n        }\n      });\n    }\n\n    this.getQuestion();\n  }\n\n  handleClick(index) {\n    if (index === 1) {\n      this.setState({\n        truthClicked: true,\n        dareClicked: false\n      });\n    } else {\n      this.setState({\n        dareClicked: true,\n        truthClicked: false\n      });\n    }\n  }\n\n  pickAnswer(answer) {\n    if (this.state.questions[this.state.current_question_index].voted === 0) {\n      const params = new URLSearchParams();\n      params.append('question_id', this.state.questions[this.state.current_question_index].QuestionID);\n      params.append('answer', answer);\n      const options = {};\n\n      if (localStorage.getItem('token') !== null) {\n        options['headers'] = {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        };\n      }\n\n      axios.post('http://localhost:80/questions', params, options).then(result => {\n        this.state.questions[this.state.current_question_index].voted = answer;\n        this.state.questions[this.state.current_question_index].stats = result.data.stats[0];\n        this.forceUpdate();\n      }).catch(error => {\n        if ('response' in error) {\n          console.log(error.response);\n        } else {\n          console.log(error);\n        }\n      });\n    }\n  }\n\n  getQuestion() {\n    let options = {};\n\n    if (localStorage.getItem('token') !== null) {\n      options['headers'] = {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      };\n    }\n\n    axios.get('http://localhost:80/questions', options).then(result => {\n      // window.alert(JSON.stringify(result.data.question[0]))\n      result.data.question[0]['voted'] = 0;\n      result.data.question[0]['like'] = 'like';\n      result.data.question[0]['dislike'] = 'dislike';\n      result.data.question[0]['reported'] = false;\n      this.state.questions.push(result.data.question[0]);\n      this.setState({\n        'current_question_index': this.state.current_question_index === undefined ? 0 : this.state.current_question_index + 1\n      });\n      this.forceUpdate();\n    }).catch(error => {\n      if ('response' in error) {\n        console.log(error.response);\n      } else {\n        console.log(error);\n      }\n    });\n  }\n\n  onPrevClick() {\n    if (this.state.current_question_index !== undefined && this.state.current_question_index > 0) {\n      this.setState({\n        'current_question_index': this.state.current_question_index - 1\n      });\n      this.forceUpdate();\n    }\n  }\n\n  onNextClick() {\n    if (this.state.current_question_index + 1 === this.state.questions.length) {\n      this.getQuestion();\n    } else {\n      this.setState({\n        'current_question_index': this.state.current_question_index + 1\n      });\n      this.forceUpdate();\n    }\n  }\n\n  getButtonText(button) {\n    if (this.state.questions.length === 0) {\n      return '';\n    } // console.log(\"here result of questions vote--->\", this.state.questions[this.state.current_question_index])\n\n\n    if (this.state.questions[this.state.current_question_index].voted === 0) {\n      return this.state.questions[this.state.current_question_index][`Answer${button}`];\n    }\n\n    const total = this.state.questions[this.state.current_question_index].stats.Ans1Count + this.state.questions[this.state.current_question_index].stats.Ans2Count;\n    const fraction = total === 0 ? 0 : this.state.questions[this.state.current_question_index].stats[`Ans${button}Count`] / total; // percent with 2 decimals\n\n    const percent = Math.round(fraction * 10000) / 100; // return (\n    //     <div>\n    //         {\n    //             this.state.questions[this.state.current_question_index].voted === button ?\n    //                 <span className={'CheckMark'}><strong>âœ“</strong></span> :\n    //                 <span />\n    //         }\n    //         <span className={'Percent'}>{percent}%</span>\n    //         <br />\n    //         <span className={'Count'}>\n    //             {this.state.questions[this.state.current_question_index].stats[`Ans${button}Count`]} agree\n    //         </span>\n    //         <br />\n    //         <span className={'Answer'}>\n    //             {this.state.questions[this.state.current_question_index][`Answer${button}`]}\n    //         </span>\n    //     </div>\n    // );\n  }\n\n  sendScore(score) {\n    let params = new URLSearchParams();\n    params.append('score', score);\n    params.append('question_id', this.state.questions[this.state.current_question_index].QuestionID);\n    const options = {\n      'headers': {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      }\n    };\n    axios.post('http://localhost:80/user/score', params, options).catch(error => {\n      if ('response' in error) {\n        console.log(error.response);\n      } else {\n        console.log(error);\n      }\n    }).catch(error => {\n      if ('response' in error) {\n        console.log(error.response);\n      } else {\n        console.log(error);\n      }\n    });\n  }\n\n  onLikeClick() {\n    this.state.questions[this.state.current_question_index]['like'] = 'selected-like';\n    this.state.questions[this.state.current_question_index]['dislike'] = 'dislike';\n    this.sendScore(1);\n    this.forceUpdate();\n  }\n\n  onDislikeClick() {\n    this.state.questions[this.state.current_question_index]['like'] = 'like';\n    this.state.questions[this.state.current_question_index]['dislike'] = 'selected-dislike';\n    this.sendScore(-1);\n    this.forceUpdate();\n  }\n\n  onReportClick() {\n    if (this.state.questions[this.state.current_question_index].reported) {\n      return;\n    }\n\n    let params = new URLSearchParams();\n    params.append('question_id', this.state.questions[this.state.current_question_index].QuestionID);\n    const options = {\n      'headers': {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      }\n    };\n    axios.put('http://localhost:80/user/report', params, options).then(() => {\n      this.state.questions[this.state.current_question_index].reported = true;\n      this.forceUpdate();\n    }).catch(error => {\n      if ('response' in error) {\n        console.log(error.response);\n      } else {\n        console.log(error);\n      }\n    });\n  }\n\n  onSend() {\n    const params = new URLSearchParams();\n\n    if (this.state.blue === '' || this.state.red === '') {\n      return;\n    }\n\n    params.append('blue', this.state.blue);\n    params.append('red', this.state.red);\n    const options = {\n      'headers': {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      }\n    };\n    axios.put('http://localhost:80/questions', params, options).then(() => {\n      this.setState({\n        'blue': '',\n        'red': ''\n      });\n    }).catch(error => {\n      if ('response' in error) {\n        console.log(error.response);\n      } else {\n        console.log(error);\n      }\n    });\n  }\n\n  getVoteUI() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: 'ButtonsContainer',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: 'NavigationButton',\n      onClick: this.onPrevClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 17\n      }\n    }, '<'), /*#__PURE__*/React.createElement(\"button\", {\n      className: 'ChoiceButton',\n      id: 'blue_button',\n      onClick: () => {\n        this.handleClick(1);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 17\n      }\n    }, \"Truth\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 26\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 32\n      }\n    }), this.state.truthClicked ? this.getButtonText(1) : ''), /*#__PURE__*/React.createElement(\"div\", {\n      id: 'or',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 32\n      }\n    }, \"or\")), /*#__PURE__*/React.createElement(\"button\", {\n      className: 'ChoiceButton',\n      id: 'red_button',\n      onClick: () => {\n        this.handleClick(2);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 17\n      }\n    }, \"Dare\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 31\n      }\n    }), this.state.dareClicked ? this.getButtonText(2) : ''), /*#__PURE__*/React.createElement(\"button\", {\n      className: 'NavigationButton',\n      onClick: this.onNextClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 17\n      }\n    }, '>'));\n  }\n\n  getSubmitForm() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: 'SubmitQuestion',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 17\n      }\n    }, \"Send your own questions:\"), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.onSend,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: 'text',\n      maxLength: '128',\n      size: '64',\n      placeholder: 'Type here...',\n      onChange: event => {\n        this.setState({\n          'blue': event.target.value\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      className: 'Send',\n      type: 'submit',\n      value: \"Submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 21\n      }\n    })));\n  }\n\n  getUserActionsUI() {\n    // originally set as null\n    if (localStorage.getItem('token') === null) {\n      return;\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 13\n      }\n    }, this.getSubmitForm());\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 13\n      }\n    }, this.getVoteUI(), this.getUserActionsUI());\n  }\n\n}\n\nexport default VotePage;","map":{"version":3,"sources":["C:/Users/Stefan Madalin/Desktop/ProiectPW/react-frontend/src/components/VotePage/VotePage.js"],"names":["React","axios","VotePage","Component","constructor","props","state","truthClicked","dareClicked","getQuestion","bind","onPrevClick","onNextClick","pickAnswer","getButtonText","onLikeClick","onDislikeClick","onReportClick","onSend","sendScore","getVoteUI","getUserActionsUI","getSubmitForm","handleClick","componentDidMount","match","params","post","id","then","result","alert","data","message","catch","error","response","undefined","setState","console","log","index","answer","questions","current_question_index","voted","URLSearchParams","append","QuestionID","options","localStorage","getItem","stats","forceUpdate","get","question","push","length","button","total","Ans1Count","Ans2Count","fraction","percent","Math","round","score","reported","put","blue","red","event","target","value","render"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport './VotePage.scss';\nimport axios from \"axios\";\n\nclass VotePage extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            'questions': [],\n            truthClicked: false,\n            dareClicked: false\n        };\n\n        this.getQuestion = this.getQuestion.bind(this);\n        this.onPrevClick = this.onPrevClick.bind(this);\n        this.onNextClick = this.onNextClick.bind(this);\n        this.pickAnswer = this.pickAnswer.bind(this);\n        this.getButtonText = this.getButtonText.bind(this);\n        this.onLikeClick = this.onLikeClick.bind(this);\n        this.onDislikeClick = this.onDislikeClick.bind(this);\n        this.onReportClick = this.onReportClick.bind(this);\n        this.onSend = this.onSend.bind(this);\n        this.sendScore = this.sendScore.bind(this);\n        this.getVoteUI = this.getVoteUI.bind(this);\n        this.getUserActionsUI = this.getUserActionsUI.bind(this);\n        this.getSubmitForm = this.getSubmitForm.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n    }\n\n    componentDidMount() {\n\n        if ('id' in this.props.match.params) {\n            axios.post(\n                `http://localhost:80/confirmation/${this.props.match.params.id}`\n            ).then((result) => {\n                alert(result.data.message);\n            }).catch((error) => {\n                if (error.response !== undefined) {\n                    this.setState({ 'register_message': error.response.data.error });\n                } else {\n                    console.log(error);\n                }\n            })\n        }\n\n        this.getQuestion();\n    }\n\n    handleClick(index) {\n\n        if (index === 1) {\n\n            this.setState({\n                truthClicked: true,\n                dareClicked: false\n            })\n        } else {\n\n            this.setState({\n                dareClicked: true,\n                truthClicked: false\n            })\n        }\n    }\n    pickAnswer(answer) {\n        if (this.state.questions[this.state.current_question_index].voted === 0) {\n            const params = new URLSearchParams();\n\n            params.append('question_id', this.state.questions[this.state.current_question_index].QuestionID);\n            params.append('answer', answer);\n\n            const options = {}\n\n            if (localStorage.getItem('token') !== null) {\n                options['headers'] = {\n                    'Authorization': `Bearer ${localStorage.getItem('token')}`\n                }\n            }\n\n            axios.post(\n                'http://localhost:80/questions',\n                params,\n                options\n            ).then((result) => {\n                this.state.questions[this.state.current_question_index].voted = answer;\n                this.state.questions[this.state.current_question_index].stats = result.data.stats[0];\n\n                this.forceUpdate();\n            }).catch((error) => {\n                if ('response' in error) {\n                    console.log(error.response);\n                } else {\n                    console.log(error);\n                }\n            });\n        }\n    }\n\n    getQuestion() {\n        let options = {};\n\n        if (localStorage.getItem('token') !== null) {\n            options['headers'] = {\n                'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n        }\n\n        axios.get(\n            'http://localhost:80/questions',\n            options\n        ).then((result) => {\n\n            // window.alert(JSON.stringify(result.data.question[0]))\n            result.data.question[0]['voted'] = 0;\n            result.data.question[0]['like'] = 'like';\n            result.data.question[0]['dislike'] = 'dislike';\n            result.data.question[0]['reported'] = false;\n\n            this.state.questions.push(result.data.question[0]);\n\n            this.setState({\n                'current_question_index': this.state.current_question_index === undefined ?\n                    0 :\n                    this.state.current_question_index + 1\n            })\n\n            this.forceUpdate();\n        }).catch((error) => {\n            if ('response' in error) {\n                console.log(error.response);\n            } else {\n                console.log(error);\n            }\n        });\n    }\n\n    onPrevClick() {\n        if (this.state.current_question_index !== undefined &&\n            this.state.current_question_index > 0) {\n            this.setState({ 'current_question_index': this.state.current_question_index - 1 });\n            this.forceUpdate();\n        }\n    }\n\n    onNextClick() {\n        if (this.state.current_question_index + 1 === this.state.questions.length) {\n            this.getQuestion();\n        } else {\n            this.setState({ 'current_question_index': this.state.current_question_index + 1 });\n\n            this.forceUpdate();\n        }\n    }\n\n    getButtonText(button) {\n\n        if (this.state.questions.length === 0) {\n            return ''\n        }\n        // console.log(\"here result of questions vote--->\", this.state.questions[this.state.current_question_index])\n        if (this.state.questions[this.state.current_question_index].voted === 0) {\n            return this.state.questions[this.state.current_question_index][`Answer${button}`];\n        }\n\n        const total = this.state.questions[this.state.current_question_index].stats.Ans1Count +\n            this.state.questions[this.state.current_question_index].stats.Ans2Count;\n\n        const fraction = (\n            total === 0 ?\n                0 :\n                (this.state.questions[this.state.current_question_index].stats[`Ans${button}Count`] / total)\n        );\n\n        // percent with 2 decimals\n        const percent = Math.round(fraction * 10000) / 100;\n\n        // return (\n        //     <div>\n        //         {\n        //             this.state.questions[this.state.current_question_index].voted === button ?\n        //                 <span className={'CheckMark'}><strong>âœ“</strong></span> :\n        //                 <span />\n        //         }\n        //         <span className={'Percent'}>{percent}%</span>\n        //         <br />\n        //         <span className={'Count'}>\n        //             {this.state.questions[this.state.current_question_index].stats[`Ans${button}Count`]} agree\n        //         </span>\n        //         <br />\n        //         <span className={'Answer'}>\n        //             {this.state.questions[this.state.current_question_index][`Answer${button}`]}\n        //         </span>\n        //     </div>\n        // );\n    }\n\n    sendScore(score) {\n        let params = new URLSearchParams();\n\n        params.append('score', score);\n        params.append('question_id', this.state.questions[this.state.current_question_index].QuestionID);\n\n        const options = {\n            'headers': {\n                'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n        };\n\n        axios.post(\n            'http://localhost:80/user/score',\n            params,\n            options\n        ).catch((error) => {\n            if ('response' in error) {\n                console.log(error.response);\n            } else {\n                console.log(error);\n            }\n        }).catch((error) => {\n            if ('response' in error) {\n                console.log(error.response);\n            } else {\n                console.log(error);\n            }\n        });\n    }\n\n    onLikeClick() {\n        this.state.questions[this.state.current_question_index]['like'] = 'selected-like';\n        this.state.questions[this.state.current_question_index]['dislike'] = 'dislike';\n\n        this.sendScore(1);\n\n        this.forceUpdate();\n    }\n\n    onDislikeClick() {\n        this.state.questions[this.state.current_question_index]['like'] = 'like';\n        this.state.questions[this.state.current_question_index]['dislike'] = 'selected-dislike';\n\n        this.sendScore(-1);\n\n        this.forceUpdate();\n    }\n\n    onReportClick() {\n        if (this.state.questions[this.state.current_question_index].reported) {\n            return;\n        }\n        let params = new URLSearchParams();\n\n        params.append('question_id', this.state.questions[this.state.current_question_index].QuestionID);\n\n        const options = {\n            'headers': {\n                'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n        };\n\n        axios.put(\n            'http://localhost:80/user/report',\n            params,\n            options\n        ).then(() => {\n            this.state.questions[this.state.current_question_index].reported = true;\n\n            this.forceUpdate();\n        }).catch((error) => {\n            if ('response' in error) {\n                console.log(error.response);\n            } else {\n                console.log(error);\n            }\n        });\n    }\n\n    onSend() {\n        const params = new URLSearchParams();\n\n        if (this.state.blue === '' || this.state.red === '') {\n            return;\n        }\n\n        params.append('blue', this.state.blue);\n        params.append('red', this.state.red);\n\n        const options = {\n            'headers': {\n                'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n        };\n\n        axios.put(\n            'http://localhost:80/questions',\n            params,\n            options\n        ).then(() => {\n            this.setState({\n                'blue': '',\n                'red': ''\n            });\n        }).catch((error) => {\n            if ('response' in error) {\n                console.log(error.response);\n            } else {\n                console.log(error);\n            }\n        });\n    }\n\n    getVoteUI() {\n        return (\n            <div className={'ButtonsContainer'}>\n                <button className={'NavigationButton'} onClick={this.onPrevClick}>{'<'}</button>\n                <button className={'ChoiceButton'} id={'blue_button'}\n                    onClick={() => { this.handleClick(1) }}>\n                    Truth<br /><br />\n                    {\n                        this.state.truthClicked ? this.getButtonText(1) : ''\n                    }\n                </button>\n                <div id={'or'}><strong>or</strong></div>\n                <button className={'ChoiceButton'} id={'red_button'}\n                    onClick={() => { this.handleClick(2) }}>\n                    Dare<br /><br />\n                    {\n                        this.state.dareClicked ? this.getButtonText(2) : ''\n                    }\n                </button>\n                <button className={'NavigationButton'} onClick={this.onNextClick}>{'>'}</button>\n            </div>\n        )\n    }\n\n    getSubmitForm() {\n        return (\n            <div className={'SubmitQuestion'}>\n                <h1>Send your own questions:</h1>\n                <form onSubmit={this.onSend}>\n                    <input type={'text'} maxLength={'128'} size={'64'}\n                        placeholder={'Type here...'}\n                        onChange={(event) => { this.setState({ 'blue': event.target.value }) }} />\n                    <input className={'Send'} type={'submit'} value=\"Submit\" />\n                </form>\n            </div>\n        )\n    }\n\n    getUserActionsUI() {\n        // originally set as null\n        if (localStorage.getItem('token') === null) {\n            return;\n        }\n\n        return (\n            <div>\n                {this.getSubmitForm()}\n            </div>\n        )\n    }\n\n    render() {\n        return (\n            <div>\n                {this.getVoteUI()}\n                {this.getUserActionsUI()}\n            </div>\n        )\n    }\n}\n\nexport default VotePage;"]},"metadata":{},"sourceType":"module"}